{"version":3,"sources":["app/pinnacle3.coffee","app/srcs/bar.coffee","node_modules/auto-reload-brunch/vendor/auto-reload.js"],"names":[],"mappings":"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,IAAiB,IAAC,OAAM,CAAC,KAAK,CAAC,WAAhC,KAAgD;IAChE,KAAK,CAAC,GAAN,CAAU,IAAC,KAAX;EAPW;;gBASb,YAAW,SAAC,MAAD;AACT;IAAA,QAAQ,IAAI,CAAC,GAAL,CAAS,MAAT,IAAmB;IAC3B,IAAG,QAAQ,GAAX;MAAoB,QAAQ,KAA5B;;IACA,IAAC,KAAI,CAAC,KAAK,CAAC,CAAZ,GAAgB;IAChB,IAAC,KAAI,CAAC,KAAK,CAAC,CAAZ,GAAgB;WAChB,IAAC,KAAI,CAAC,QAAQ,CAAC,KAAf,GAAuB,GAAG,CAAC,YAAJ,CAAiB,MAAjB,EAAyB,IAAC,IAA1B,EAA+B,IAAC,MAAhC,EAAuC,IAAC,YAAxC;EALd;;;;;;;;;;;AC1Bb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"public/js/pinnacle3.js","sourcesContent":["# @Author: Guillaume de Matos <schlipak>\n# @Date:   18-Aug-2016\n# @Email:  g.de.matos@free.fr\n# @Last modified by:   schlipak\n# @Last modified time: 19-Aug-2016\n\nBar     = require 'srcs/bar'\n\nmodule.exports = class Pinnacle3\n\t_animation_frame_id_ = -1\n\n\tconstructor: (@target, @params) ->\n\t\t@width = window.innerWidth\n\t\t@height = window.innerHeight\n\t\t@bars = new Array\n\t\t@lights = new Array\n\t\t@radius = 300\n\t\t@paused = true\n\t\t@hue = ((@params.color && @params.color.hue) || 0)\n\t\t@range = ((@params.color && @params.color.range) || 180)\n\t\t@lightOffset = ((@params.color && @params.color.lightOffset) || 10)\n\t\t@initScene()\n\n\tinitScene: () ->\n\t\t@renderer = new THREE.WebGLRenderer({\n\t\t\tantialias: true\n\t\t})\n\t\t@renderer.setClearColor(0x1A1A1A, 1)\n\t\t@renderer.autoClear = false\n\t\t@camera = new THREE.PerspectiveCamera(\n\t\t\t45, @width / @height,\n\t\t\t0.1, 10000\n\t\t)\n\t\t@scene = new THREE.Scene()\n\t\t@scene.add @camera\n\t\t@camera.position.x = 0\n\t\t@camera.position.y = Math.cos(Math.PI / 4) * @radius\n\t\t@camera.position.z = Math.sin(Math.PI / 4) * @radius\n\t\t@camera.lookAt @scene.position\n\t\t@renderer.setSize @width, @height\n\t\t@target.appendChild @renderer.domElement\n\t\tfor i in [1..99] by 1\n\t\t\t@bars.push new Bar(@scene, i, @params)\n\t\tlight = new THREE.AmbientLight(0xFFFFFF)\n\t\t@scene.add light\n\t\t@setupParticles()\n\t\t@setupComposer()\n\t\tif @params.mouse then @initMouse()\n\n\tsetupParticles: () ->\n\t\t@particles = new THREE.Geometry()\n\t\tloader = new THREE.TextureLoader()\n\t\tcol = tinycolor('hsl(0, 100%, 50%)').toHsl()\n\t\tcol.h = @hue\n\t\tmat = new THREE.PointsMaterial({\n\t\t\tcolor: new THREE.Color(tinycolor(col).toRgbString()),\n\t\t\tsize: 8,\n\t\t\tmap: loader.load('img/spark.png'),\n\t\t\tblending: THREE.AdditiveBlending,\n\t\t\ttransparent: true\n\t\t})\n\t\tmat.alphaTest = 0.1\n\t\tfor i in [1..500] by 1\n\t\t\tcoords = {\n\t\t\t\tx: Math.random() * (@radius * 2) - @radius,\n\t\t\t\ty: Math.random() * (@radius * 2) - @radius\n\t\t\t\tz: Math.random() * (@radius * 2) - @radius,\n\t\t\t}\n\t\t\tparticle = new THREE.Vector3(coords.x, coords.y, coords.z)\n\t\t\tparticle.velocity = new THREE.Vector3(0, -Math.random(), 0)\n\t\t\t@particles.vertices.push(particle)\n\t\t@particleSystem = new THREE.Points(@particles, mat)\n\t\t@scene.add @particleSystem\n\n\tsetupComposer: () ->\n\t\t@composer = new THREE.EffectComposer(@renderer)\n\t\t@composer.addPass(new THREE.RenderPass(@scene, @camera))\n\t\tif not @params.shaders or (@params.shaders and @params.shaders.shift)\n\t\t\teffect = new THREE.ShaderPass(THREE.RGBShiftShader)\n\t\t\teffect.uniforms['amount'].value = 0.0012\n\t\t\t@composer.addPass(effect)\n\t\tif not @params.shaders or (@params.shaders and @params.shaders.bloom)\n\t\t\teffect = new THREE.BloomPass(.5, 25, 5, 512)\n\t\t\t@composer.addPass(effect)\n\t\tif not @params.shaders or (@params.shaders and @params.shaders.unreal)\n\t\t\teffect = new THREE.UnrealBloomPass(512, .3, 1.5, .95)\n\t\t\t@composer.addPass(effect)\n\t\tif not @params.shaders or (@params.shaders and @params.shaders.vignette)\n\t\t\teffect = new THREE.ShaderPass(THREE.VignetteShader)\n\t\t\teffect.uniforms[\"offset\"].value = 1\n\t\t\teffect.uniforms[\"darkness\"].value = 1.2\n\t\t\t@composer.addPass(effect)\n\t\teffect = new THREE.ShaderPass(THREE.CopyShader)\n\t\teffect.renderToScreen = true\n\t\t@composer.addPass(effect)\n\t\t_this = @\n\t\twindow.addEventListener('resize', () ->\n\t\t\t_this.width = window.innerWidth\n\t\t\t_this.height = window.innerHeight\n\t\t\t_this.camera.aspect = _this.width / _this.height\n\t\t\t_this.camera.updateProjectionMatrix()\n\t\t\t_this.renderer.setSize _this.width, _this.height\n\t\t\t_this.composer.setSize _this.width, _this.height\n\t\t)\n\n\trun: (url) ->\n\t\t@audio = new Audio(url)\n\t\t@audio.crossOrigin = \"anonymous\"\n\t\t@audioCtx = new (window.AudioContext || window.webkitAudioContext)()\n\t\t@audioSrc = @audioCtx.createMediaElementSource(@audio)\n\t\t@analyser = @audioCtx.createAnalyser()\n\t\t@audioSrc.connect(@analyser)\n\t\t@audioSrc.connect(@audioCtx.destination)\n\t\t@audioData = new Uint8Array(@analyser.frequencyBinCount)\n\t\t@play()\n\n\tinitMouse: () ->\n\t\t_this = @\n\t\t@renderer.domElement.addEventListener('mousemove', (e) ->\n\t\t\tangles = {\n\t\t\t\ttheta: (Math.PI / 2) + ((e.clientX / _this.width) * (Math.PI / 8)) - (Math.PI / 16),\n\t\t\t\tphi: (Math.PI / 4) + ((e.clientY / _this.height) * (Math.PI / 8)) - (Math.PI / 16)\n\t\t\t}\n\n\t\t\tcoords = {\n\t\t\t\tx: _this.radius * Math.sin(angles.phi) * Math.cos(angles.theta),\n\t\t\t\ty: _this.radius * Math.cos(angles.phi),\n\t\t\t\tz: _this.radius * Math.sin(angles.phi) * Math.sin(angles.theta)\n\t\t\t}\n\n\t\t\t_this.camera.position.x = coords.x\n\t\t\t_this.camera.position.y = coords.y\n\t\t\t_this.camera.position.z = coords.z\n\t\t\t_this.camera.lookAt _this.scene.position\n\t\t)\n\n\tplay: () ->\n\t\t@audio.play()\n\t\t@paused = false\n\t\t@target.classList.add 'playing'\n\t\t_animation_frame_id_ = requestAnimationFrame(@animate.bind(this))\n\n\tpause: () ->\n\t\t@audio.pause()\n\t\t@paused = true\n\t\t@target.classList.remove 'playing'\n\t\tif _animation_frame_id_ != -1\n\t\t\tcancelAnimationFrame _animation_frame_id_\n\t\t\t_animation_frame_id_ = -1\n\n\ttoggle: () ->\n\t\tif @paused\n\t\t\t@play()\n\t\telse\n\t\t\t@pause()\n\n\taverage: (array) ->\n\t\tsum = 0;\n\t\tfor val in array\n\t\t\tsum += val\n\t\treturn (sum / array.length);\n\n\tanimate: () ->\n\t\t@analyser.getByteFrequencyData(@audioData)\n\t\tmiddle = ~~(@bars.length / 2) + 1\n\t\tchunkSize = ~~(@audioData.length / middle)\n\t\ti = 0\n\t\tfor bar in @bars\n\t\t\tif i < middle\n\t\t\t\tidx = middle - i - 1\n\t\t\telse\n\t\t\t\tidx = i - middle + 1\n\t\t\tfreqs = @audioData.slice(chunkSize * idx, chunkSize * (idx + 1))\n\t\t\tavg = @average(freqs)\n\t\t\tbar.setHeight(avg)\n\t\t\ti += 1\n\t\tavg = @average(@audioData)\n\t\tcol = Bar.computeColor(avg, @hue, @range, @lightOffset + 20)\n\t\t@particleSystem.rotation.y += .0003 + ((Math.pow(avg, 4) / Math.pow(255, 4)) / 10)\n\t\t@particleSystem.material.size = 4 + ((Math.pow(avg, 4) / Math.pow(255, 3)))\n\t\t@particleSystem.material.color = col\n\t\t@renderer.clear()\n\t\t@composer.render()\n\t\t_animation_frame_id_ = requestAnimationFrame(@animate.bind(this))\n","# @Author: Guillaume de Matos <schlipak>\n# @Date:   18-Aug-2016\n# @Email:  g.de.matos@free.fr\n# @Last modified by:   schlipak\n# @Last modified time: 19-Aug-2016\n\nmodule.exports = class Bar\n  @computeColor: (value, hue, range, lightOffset) ->\n    col = tinycolor('hsl(0, 100%, 50%)').toHsl()\n    col.h = (hue + (range * (value / 255))) % 360\n    light = Math.min(((value / 255) * 100) + lightOffset, 100)\n    # God dammit TinyColor!\n    if light < 1 then light += 1.0\n    if light == 1 then light = 1.1\n    col.l = light\n    return new THREE.Color(tinycolor(col).toHslString())\n\n  constructor: (scene, @index, @params) ->\n    @material = new THREE.MeshLambertMaterial(color: 0xFFFFFF)\n    @mesh = new THREE.Mesh(new THREE.BoxGeometry(4, 4, 4), @material)\n    @mesh.position.set(((@index - 50) * 4), 0, 0)\n    @hue = ((@params.color && @params.color.hue) || 0)\n    @range = ((@params.color && @params.color.range) || 45)\n    @lightOffset = ((@params.color && @params.color.lightOffset) || 5)\n    scene.add(@mesh)\n\n  setHeight: (height) ->\n    scale = Math.abs(height) / 10.0\n    if scale < 0.1 then scale = 0.01\n    @mesh.scale.y = scale\n    @mesh.scale.z = scale\n    @mesh.material.color = Bar.computeColor(height, @hue, @range, @lightOffset)\n","/* jshint ignore:start */\n(function() {\n  var WebSocket = window.WebSocket || window.MozWebSocket;\n  var br = window.brunch = (window.brunch || {});\n  var ar = br['auto-reload'] = (br['auto-reload'] || {});\n  if (!WebSocket || ar.disabled) return;\n  if (window._ar) return;\n  window._ar = true;\n\n  var cacheBuster = function(url){\n    var date = Math.round(Date.now() / 1000).toString();\n    url = url.replace(/(\\&|\\\\?)cacheBuster=\\d*/, '');\n    return url + (url.indexOf('?') >= 0 ? '&' : '?') +'cacheBuster=' + date;\n  };\n\n  var browser = navigator.userAgent.toLowerCase();\n  var forceRepaint = ar.forceRepaint || browser.indexOf('chrome') > -1;\n\n  var reloaders = {\n    page: function(){\n      window.location.reload(true);\n    },\n\n    stylesheet: function(){\n      [].slice\n        .call(document.querySelectorAll('link[rel=stylesheet]'))\n        .filter(function(link) {\n          var val = link.getAttribute('data-autoreload');\n          return link.href && val != 'false';\n        })\n        .forEach(function(link) {\n          link.href = cacheBuster(link.href);\n        });\n\n      // Hack to force page repaint after 25ms.\n      if (forceRepaint) setTimeout(function() { document.body.offsetHeight; }, 25);\n    },\n\n    javascript: function(){\n      var scripts = [].slice.call(document.querySelectorAll('script'));\n      var textScripts = scripts.map(function(script) { return script.text }).filter(function(text) { return text.length > 0 });\n      var srcScripts = scripts.filter(function(script) { return script.src });\n\n      var loaded = 0;\n      var all = srcScripts.length;\n      var onLoad = function() {\n        loaded = loaded + 1;\n        if (loaded === all) {\n          textScripts.forEach(function(script) { eval(script); });\n        }\n      }\n\n      srcScripts\n        .forEach(function(script) {\n          var src = script.src;\n          script.remove();\n          var newScript = document.createElement('script');\n          newScript.src = cacheBuster(src);\n          newScript.async = true;\n          newScript.onload = onLoad;\n          document.head.appendChild(newScript);\n        });\n    }\n  };\n  var port = ar.port || 9485;\n  var host = br.server || window.location.hostname || 'localhost';\n\n  var connect = function(){\n    var connection = new WebSocket('ws://' + host + ':' + port);\n    connection.onmessage = function(event){\n      if (ar.disabled) return;\n      var message = event.data;\n      var reloader = reloaders[message] || reloaders.page;\n      reloader();\n    };\n    connection.onerror = function(){\n      if (connection.readyState) connection.close();\n    };\n    connection.onclose = function(){\n      window.setTimeout(connect, 1000);\n    };\n  };\n  connect();\n})();\n/* jshint ignore:end */\n"]}